# Git flow

Изменить флоу мерджа фичи в **develop** ветку.
Вместо влития всей фичи целиком, вливать кусочками.

- Улучшается качество ревью.
- Уменьшается риск возникновения конфликтов, а если и будут, то гораздо меньше.
- `feature/issue_<номер задачи>` в будущем будет сложно искать свои ветки, возможно сделать `feature/<autor name>/issue_<номер задачи>`.

Добавить шаблон к коммит мессаджам:
```
<DLS>-<Номер таска>/<Номер пулл-реквеста (если дробили)>: <Краткое описание задачи>.

**Причина:**
<Описание причины в неопределенной форме>.

**Содержание:**
<Описание содержания пулл-реквеста. Можно тезисно>.
```

Можно будет написать хуки, для вставки шаблона.

**Solution**: 
Шаблон коммитов принят для `merge`-коммитов.
Продемонстрировать подход влития фичи по частям на примере фичи "Дела".

# File structure

Убрать разделение аппы на `feature` и `web`.
Пока нет какой-то единой структуры папок, пока сложно ориентироваться по проекту. Имеет смысл стандартизировать этот момент.

В каждом ПРе требовать описание Причина - Содержание.

## Предложение:

- lib/
    - common/
        - core/ (какие либо основные типы, экстеншены и пр.)
        - widget/
        - gen/ (все, что генерится кроме файлов `part of`)
        ...
    - feature/ (списком все фичи)
        - some_big_feature:
		- first_subfeature:
		- second_subfeature:
			- bloc/
		        - model/
		        - widget/
		            - ui/ (исключительно верстка, возможно разделение на `web`/`mobile`, но с именованием нужно что то придумать)
		                - web
		                - mobile
		            - navigation/
		                - page/
		                - guard/
		                - transition/ (специфичные анимации под конкретные экраны)
		                - feature_routes
		            - прочие виджеты, не несущие `ui` нагрузки.
		        - data/ (тут тоже имеет смысл обсудить)
		            - repository/
		            <!-- - dto/ (если делаем) -->
		            - datasource/

Подобная проблема существует и в `asset`ах. Там тоже было бы неплохо навести порядок. Например делить ресурсы по фичам?

**Solution:**
Написать дизайнеру, попросить нормально именовать иконки с одинаковыми именами для дубликатов.
Файловую структуру продемонстрировать в фиче "Дела".

# BLoC

1. В `BLoC`е не должно быть ничего, связанного с UI (Каких либо `Controller`ов UI-ных так же не должно быть).
2. Выносить какую либо логику в отдельные классы.
    `BLoC` итак занимает обработкой ивентов в определенно последовательности и собирает `State`ы. Если мы будем внутри него еще и логику писать, потом будет очень сложно писать тесты, т.к. их количество на каждый блок будет расти в геометрической прогрессии.

**Solution:**
✅ Accepted.

Любое упоминание UI в `BLoC`е недопустимо.
Логика получения данных с какого либо источника данных перекладывается на `Repository`.


# Arch

Не нашел единого вида архитектуры.

## Предложение:

`UI` -> `Scope`* -> `BLoC` (Controller / Other logic component) -> `Repository` -> `API`

`Repository` и `API` должны быть под интерфейсами.

## Model

Любой парсинг моделей писать на **freezed**. Ускорится разработка и уменьшится риск ошибится с ключами и прочим.

**Solution:**
✅ Accepted.

## Scope:

Опциональное предложение, внести дополнительную прослойку между `UI` и остальным миром (По сути паттерн **Mediator**).
Под каждый функционал будет создаваться отдельный `Scope`, который будет иметь шорткаты к получению данных и каким либо действиям.
Любое взаимодействие с конкретным функционалом будет происходить исключеительно через `Scope`.
- Единая точка входа в логику.
- Уменьшается зависимость от `BLoC`а.
- Понятное место, где собираются все зависимости для конкретного функционала.

**Solution:**
❌ Rejected.

# Навигация

1. Переход на **AutoRoute**.
2. Проработать вложенность навигации (Есть некоторые не структурные решения).
3. Переход на полностью типизированную навигацию.

**Solution:**
✅ Accepted.
Добавлено в список техдолга.

# Зависимости

- Навести порядок в `pubspec`.
- Убрать ненужные UI зависимости (что-то простое лучше самим написать или копипастнуть).
- fvm
- Makefile

**Solution:**
✅ Accepted.
Взято в ближайшую работу Klopot A.

# Docs

Линт на обязательную документацию приводит к очень странным вещам.

Пример:
```dart
/// раскрашенная safearea
class DLSSafeArea extends StatelessWidget {
  /// конструктор
  const DLSSafeArea({
```

Абсолютно не имеющие смысла коментарии. Иногда код и так понятен и "самодокументируем".
Возможно стоит идти в другую сторону, если код требует документации или комментариев, возможно стоит его как то декомпозировать или пересмотреть.

**Solution:**
Частично отключаем обязательную документацию:
1. Переменные класса.
2. Конструкторы.
3. Классы.

Оставляем только на `публичные методы`.


# Summary

Составить тех. долг:
1. Навигация (Переезд на `AutoRoute`).
2. Описание темы (Описать тему под все компоненты дизайна).
3. Cubit -> BLoC (Перевести имеющиеся `Cubit`ы на `BLoC` при необходимости).
4. Довыпилить Riverpod (Осталось одно упоминание: `WebCallAppBar`).
5. Закинуть в гитигнор freezed и другие генерящиеся файлы.
6. CI / CD.
